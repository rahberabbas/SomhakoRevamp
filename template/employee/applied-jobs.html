{% extends 'base.html' %}
{% load static %}

{% block body %}
    
    

            <!-- START SIGN-UP MODAL -->
            <div class="modal fade" id="signupModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-body p-5">
                            <div class="position-absolute end-0 top-0 p-3">
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="auth-content">
                                <div class="w-100">
                                    <div class="text-center mb-4">
                                        <h5>Sign Up</h5>
                                        <p class="text-muted">Sign Up and get access to all the features of Somhako</p>
                                    </div>
                                    <form action="#" class="auth-form">
                                        <div class="mb-3">
                                            <label for="usernameInput" class="form-label">Username</label>
                                            <input type="text" class="form-control" id="usernameInput" placeholder="Enter your username">
                                        </div>
                                        <div class="mb-3">
                                            <label for="passwordInput" class="form-label">Email</label>
                                            <input type="email" class="form-control" id="emailInput" placeholder="Enter your email">
                                        </div>
                                        <div class="mb-3">
                                            <label for="emailInput" class="form-label">Password</label>
                                            <input type="password" class="form-control" id="passwordInput" placeholder="Password">
                                        </div>
                                        <div class="mb-4">
                                            <div class="form-check"><input class="form-check-input" type="checkbox" id="flexCheckDefault">
                                                <label class="form-check-label" for="flexCheckDefault">I agree to the <a href="javascript:void(0)" class="text-primary form-text text-decoration-underline">Terms and conditions</a></label>
                                            </div>
                                        </div>
                                        <div class="text-center">
                                            <button type="submit" class="btn btn-primary w-100">Sign Up</button>
                                        </div>
                                    </form>
                                    <div class="mt-3 text-center">
                                        <p class="mb-0">Already a member ? <a href="sign-in.html" class="form-text text-primary text-decoration-underline"> Sign-in </a></p>
                                    </div>
                                </div>
                            </div>
                        </div><!--end modal-body-->
                    </div><!--end modal-content-->
                </div><!--end modal-dialog-->
            </div>
            <!-- END SIGN-UP MODAL -->

            
            <div class="main-content">

                <div class="page-content">

                    

                    <!-- START SHAPE -->
                    <div class="position-relative" style="z-index: 1">
                        <div class="shape">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 250">
                                <path fill="#FFFFFF" fill-opacity="1"
                                    d="M0,192L120,202.7C240,213,480,235,720,234.7C960,235,1200,213,1320,202.7L1440,192L1440,320L1320,320C1200,320,960,320,720,320C480,320,240,320,120,320L0,320Z"></path>
                            </svg>
                        </div>
                    </div>
                    <!-- END SHAPE -->


                    <!-- START MANAGE-JOBS -->
                    <section class="section" style="margin-top: 100px;">
                        <div class="container">
                            <div class="row align-items-center">
                                <div class="col-lg-7">
                                    <div class="mb-4 mb-lg-0">
                                        <h3 class="mb-0"> Applied Jobs </h3>
                                    </div>
                                </div><!--end col-->
                                <div class="col-lg-4">
                                    <div class="candidate-list-widgets">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div class="selection-widget">
                                                    <select class="form-select" data-trigger name="choices-single-filter-orderby" id="choices-single-filter-orderby" aria-label="Default select example">
                                                        <option value="df">Default</option>
                                                        <option value="ne">Newest</option>
                                                        <option value="od">Oldest</option>
                                                        <option value="rd">Random</option>
                                                    </select>
                                                </div>
                                            </div><!--end col-->
                                            <div class="col-lg-6">
                                                <div class="selection-widget mt-2 mt-lg-0">
                                                    <select class="form-select" data-trigger name="choices-candidate-page" id="choices-candidate-page" aria-label="Default select example">
                                                        <option value="df">All</option>
                                                        <option value="ne">Last 2 Month</option>
                                                        <option value="ne">Last 6 Month</option>
                                                        <option value="ne">Last 12 Month</option>
                                                        <option value="ne">Last 2 Year</option>
                                                    </select>
                                                </div>
                                            </div><!--end col-->
                                        </div><!--end row-->
                                    </div><!--end candidate-list-widgets-->
                                </div><!--end col-->
                            </div><!--end row-->
                            <div class="row">
                                <div class="col-lg-12" style="box-shadow: rgba(0, 0, 0, 0.15) 0px 5px 15px 0px; padding: top 15px;">
                                    <div id="applied_data">
                                    {% for i in apply %}
                                    <div class="job-box card mt-4">
                                        <div class="card-body p-4">
                                            <div class="row">
                                                <div class="col-lg-1">
                                                    <a href="company-details.html"><img src="{% static 'assets/images/featured-job/img-01.png' %}" alt="" class="img-fluid rounded-3"></a>
                                                </div><!--end col-->
                                                <div class="col-lg-7">
                                                    <div class="mt-3 mt-lg-0">
                                                        <h5 class="fs-17 mb-1"><a href="" class="text-dark">{{i.job.title}}</a></h5>
                                                        <ul class="list-inline mb-0">
                                                            <li class="list-inline-item">
                                                                <p class="text-muted fs-14 mb-0">{{i.job.company_name}}</p>
                                                            </li>
                                                            <li class="list-inline-item">
                                                                <p class="text-muted fs-14 mb-0"><i class="mdi mdi-map-marker"></i> {{i.job.location}}</p>
                                                            </li>
                                                            <li class="list-inline-item">
                                                                <p class="text-muted fs-14 mb-0"><i class="uil uil-wallet"></i> â‚¹{{i.job.salary}} / month</p>
                                                            </li>
                                                        </ul>
                                                        <div class="mt-2">
                                                            <span class="badge bg-soft-danger mt-1">{{i.job.get_job_type_display}}</span>
                                                            <span class="badge bg-soft-warning mt-1">Urgent</span>
                                                        </div>
                                                    </div>
                                                </div><!--end col-->
                                                <div class="col-lg-4 align-self-center">
                                                    <ul class="list-inline mt-3 mb-0">

                                                        <li class="list-inline-item">
                                                            <p class="text-muted fs-14 mb-0"><i class="uil uil-clock" style="margin-right: 4px;"></i>14 days ago</p>
                                                        </li>



                                                        <li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="Status">
                                                            <span class="badge rounded-pill bg-success">Applied</span>
                                                            </a>
                                                        </li>
                                                        <li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="View submission">
                                                            <a href="#" class="avatar-sm bg-soft-success d-inline-block text-center rounded-circle fs-18">
                                                                <i class="uil uil-eye"></i>
                                                            </a>
                                                        </li>
                                                        <form action="">
                                                            {% csrf_token %}
                                                        <li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="Remove">
                                                            <a href="javascript:void(0)" id="delbtnapple"  data-id="{{i.id}}" 
                                                        class="avatar-sm bg-soft-danger d-inline-block text-center rounded-circle fs-18">
                                                                <i class="uil uil-trash-alt"></i>
                                                            </a>
                                                        </li></form>
                                                    </ul>
                                                </div><!--end col-->
                                            </div><!--end row-->
                                        </div>
                                    </div><!--end job-box-->
                                    {% endfor %}
                                </div>
                                    
                                </div><!--end col-->    
                            </div><!--end row-->

                            <!-- <div class="row">
                                <div class="col-lg-12 mt-4 pt-2">
                                    <nav aria-label="Page navigation example">
                                        <ul class="pagination job-pagination mb-0 justify-content-center">
                                            <li class="page-item disabled">
                                                <a class="page-link" href="javascript:void(0)" tabindex="-1">
                                                    <i class="mdi mdi-chevron-double-left fs-15"></i>
                                                </a>
                                            </li>
                                            <li class="page-item active"><a class="page-link" href="javascript:void(0)">1</a></li>
                                            <li class="page-item"><a class="page-link" href="javascript:void(0)">2</a></li>
                                            <li class="page-item"><a class="page-link" href="javascript:void(0)">3</a></li>
                                            <li class="page-item"><a class="page-link" href="javascript:void(0)">4</a></li>
                                            <li class="page-item">
                                                <a class="page-link" href="javascript:void(0)">
                                                    <i class="mdi mdi-chevron-double-right fs-15"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </nav>
                                </div>
                            </div> -->
                        </div><!--end container-->
                    </section>
                    <!-- END MANAGE-JOBS -->

                    <!-- DELETE Modal -->
                    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModal" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="staticBackdropLabel">Delete Jobs ?</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div>
                                        <h6 class="text-danger"><i class="uil uil-exclamation-triangle"></i> Warning: Are you sure you want to delete applied job history?</h6>
                                        <p class="text-muted"> Your applied job history will be permenently removed and you won't be able to see them again, including the once you're shared with your friends.</p>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary btn-sm" data-bs-dismiss="modal">Cancel</button>
                                    <button type="button" class="btn btn-danger btn-sm">Yes, delete</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- END DELETE MODAL -->

                </div>
                <!-- End Page-content -->
                <script>
                    $(document).on('click','#delbtnapple', function(e){
                        e.preventDefault()
                        console.log('clicked')
                        let id = $(this).attr("data-id")
                        console.log(id)
                        let csr = $("input[name=csrfmiddlewaretoken]").val();
                        mydata = {sid: id, csrfmiddlewaretoken: csr}
                        mythis = this;
                        $.ajax({
                            url: "{% url 'jobapp:applied_delete' %}",
                            method: "POST",
                            data: mydata,
                            success: function(data){
                                x = data.arr
                                y = data.applied_job
                                if(data.status == 1){
                                    console.log("Deleted")
                                    $('#applied_data').empty();
                                    for(v in x){
                                        for(z in y){
                                            if(y[z].job_id == x[v].id){
                                                let exp="",job=""
                                                if(v.experince == '1'){exp="(0-2 Yrs Exp.)";}
                                                else if(x[v].experince == '2'){
                                                    exp="2-4 Yrs Exp.";
                                                }
                                                else if(x[v].experince == '3'){
                                                    exp="5+ Yrs Exp.";
                                                }
                                                else{
                                                    exp="No experience"
                                                }
                                                
        
                                                if(x[v].job_type == '1'){
                                                    job="Full Time";
                                                }
                                                else if(x[v].job_type == '2'){
                                                    job="Part Time";
                                                }
                                                else if(x[v].job_type == '3'){
                                                    job="Internship";
                                                }
                                                else if(x[v].job_type == '4'){
                                                    job="Contract";
                                                }
                                                console.log(x[v]);


                                        $('#applied_data').append('<div class="job-box card mt-4"><div class="card-body p-4"><div class="row"><div class="col-lg-1"><a href="company-details.html"><img src="" alt=""class="img-fluid rounded-3"></a></div><div class="col-lg-7"><h5><div class="mt-3 mt-lg-0"><div class="fs-17 mb-1"><a href="" class="text-dark">'+ x[v].title +'</a></div></div></h5><ul class="list-inline mb-0"><li class="list-inline-item"><p class="text-muted fs-14 mb-0">'+x[v].company_name+'</p></li><li class="list-inline-item"><p class="text-muted fs-14 mb-0"><i class="mdi mdi-map-marker"></i>'+ x[v].location +'</p></li><li class="list-inline-item"><p class="text-muted fs-14 mb-0"><i class="uil uil-wallet"></i> â‚¹'+ x[v].salary+' / month</p></li></ul><div class="mt-2"><span class="badge bg-soft-danger mt-1">{{i.job.get_job_type_display}}</span><span class="badge bg-soft-warning mt-1">Urgent</span></div></div></div><div class="col-lg-4 align-self-center"><ul class="list-inline mt-3 mb-0"><li class="list-inline-item"><p class="text-muted fs-14 mb-0"><i class="uil uil-clock" style="margin-right: 4px;"></i>14 days ago</p></li><li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="Status"><span class="badge rounded-pill bg-success">Applied</span></a></li><li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="View submission"><a href="#" class="avatar-sm bg-soft-success d-inline-block text-center rounded-circle fs-18"><i class="uil uil-eye"></i></a></li><form action="">{% csrf_token %}<li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="Remove"><a href="javascript:void(0)" id="delbtnapple"  data-id="'+ y[z].id +'" class="avatar-sm bg-soft-danger d-inline-block text-center rounded-circle fs-18"><i class="uil uil-trash-alt"></i></a></li></form></ul></div></div></div></div>');
                                            }

                                            
                                    }
                                }

                                }
                                else{
                                    console.log("Error")
                                }
                            }
                        })
                    })
                </script>

{% endblock %}


<!-- <div class="job-box card mt-4"><div class="card-body p-4"><div class="row"><div class="col-lg-1"><a href="company-details.html"><img src="{% static 'assets/images/featured-job/img-01.png' %}" alt=""class="img-fluid rounded-3"></a></div><div class="col-lg-7"><div class="mt-3 mt-lg-0"><div class="fs-17 mb-1"><a href="{% url 'jobapp:single-job' i.job.id %}" class="text-dark">{{i.job.title}}</a></div>div>h5><ul class="list-inline mb-0"><li class="list-inline-item"><p class="text-muted fs-14 mb-0">{{i.job.company_name}}</p></li><li class="list-inline-item"><p class="text-muted fs-14 mb-0"><i class="mdi mdi-map-marker"></i> {{i.job.location}}</p></li><li class="list-inline-item"><p class="text-muted fs-14 mb-0"><i class="uil uil-wallet"></i> â‚¹{{i.job.salary}} / month</p></li></ul><div class="mt-2"><span class="badge bg-soft-danger mt-1">{{i.job.get_job_type_display}}</span><span class="badge bg-soft-warning mt-1">Urgent</span></div></div></div><div class="col-lg-4 align-self-center"><ul class="list-inline mt-3 mb-0"><li class="list-inline-item"><p class="text-muted fs-14 mb-0"><i class="uil uil-clock" style="margin-right: 4px;"></i>14 days ago</p></li><li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="Status"><span class="badge rounded-pill bg-success">Applied</span></a></li><li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="View submission"><a href="#" class="avatar-sm bg-soft-success d-inline-block text-center rounded-circle fs-18"><i class="uil uil-eye"></i></a></li><form action="">{% csrf_token %}<li class="list-inline-item" data-bs-toggle="tooltip" data-bs-placement="top" title="Remove"><a href="javascript:void(0)" id="delbtnapple"  data-id="{{i.id}}" class="avatar-sm bg-soft-danger d-inline-block text-center rounded-circle fs-18"><i class="uil uil-trash-alt"></i></a></li></form></ul></div></div></div></div> -->